<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
  <meta name="theme-color" content="#050d14"/>
  <meta name="mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
  <meta name="apple-mobile-web-app-title" content="Weltkind"/>
  <link rel="manifest" href="manifest.json"/>
  <link rel="apple-touch-icon" href="icons/icon-192.png"/>
  <link rel="icon" href="icons/icon-192.png"/>
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600;700&family=JetBrains+Mono:wght@300;400&display=swap" rel="stylesheet"/>
  <title>Weltkind</title>
  <style>
    :root{--bg:#050d14;--surface:#0a1929;--card:#0d2137;--accent:#00e676;--accent2:#00b0ff;--warn:#ff6d00;--text:#e0f7fa;--muted:#546e7a;--border:rgba(0,230,118,.12);}
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%;overflow:hidden;background:var(--bg);font-family:'Rajdhani',sans-serif;color:var(--text)}
    #bg-canvas{position:fixed;inset:0;z-index:0;opacity:.3}
    #confetti-canvas{position:fixed;inset:0;z-index:9000;pointer-events:none;display:none}
    /* Splash */
    #splash{position:fixed;inset:0;z-index:9999;background:var(--bg);display:flex;flex-direction:column;align-items:center;justify-content:center;transition:opacity .8s ease}
    #splash.out{opacity:0;pointer-events:none}
    #wire-canvas{display:block;margin-bottom:24px}
    .splash-brand{font-size:2.2rem;font-weight:700;letter-spacing:.08em;background:linear-gradient(90deg,var(--accent),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .splash-sub{margin-top:8px;font-family:'JetBrains Mono',monospace;font-size:.68rem;color:var(--muted);letter-spacing:.15em}
    .splash-bar{margin-top:32px;width:160px;height:2px;background:rgba(0,230,118,.12);border-radius:2px;overflow:hidden}
    .splash-bar-fill{height:100%;width:0%;background:var(--accent);border-radius:2px;animation:bf 2.2s ease forwards}
    @keyframes bf{to{width:100%}}
    /* Header */
    #hdr{position:fixed;top:0;left:0;right:0;z-index:200;background:rgba(5,13,20,.95);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:0 12px;display:flex;align-items:center;justify-content:space-between;height:52px;gap:6px;min-width:0}
    .hdr-brand{font-size:1rem;font-weight:700;background:linear-gradient(90deg,var(--accent),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;white-space:nowrap;flex-shrink:0;min-width:0}
    .hdr-right{display:flex;align-items:center;gap:5px;flex-shrink:0;min-width:0}
    /* Timer pill */
    #timer-pill{display:flex;align-items:center;gap:4px;padding:4px 9px;border-radius:20px;background:rgba(0,230,118,.08);border:1px solid rgba(0,230,118,.2);font-family:'JetBrains Mono',monospace;font-size:.6rem;color:var(--accent);cursor:pointer;transition:all .3s;white-space:nowrap;flex-shrink:0}
    #timer-pill:hover{background:rgba(0,230,118,.15)}
    #timer-pill.warn{background:rgba(255,109,0,.1);border-color:rgba(255,109,0,.35);color:var(--warn)}
    #timer-pill.err{background:rgba(255,23,68,.1);border-color:rgba(255,23,68,.35);color:#ff5252}
    .t-dot{width:6px;height:6px;border-radius:50%;background:currentColor;flex-shrink:0}
    @keyframes blink{0%,100%{opacity:1}50%{opacity:.25}}
    .t-dot.blink{animation:blink 1.2s infinite}
    .bell-btn{position:relative;padding:0 9px;height:34px;border-radius:10px;background:rgba(0,176,255,.08);border:1px solid rgba(0,176,255,.2);display:flex;align-items:center;justify-content:center;gap:4px;cursor:pointer;font-size:.85rem;transition:background .2s;flex-shrink:0;font-family:'JetBrains Mono',monospace;color:var(--accent2);white-space:nowrap}
    .bell-btn:hover{background:rgba(0,176,255,.2)}
    .bell-btn .bell-label{font-size:.55rem;letter-spacing:.04em;opacity:.8}
    .bell-badge{position:absolute;top:3px;right:3px;width:8px;height:8px;background:var(--warn);border-radius:50%;border:1px solid var(--bg);display:none}
    .bell-badge.show{display:block}
    /* Offline bar */
    #offline-bar{position:fixed;top:52px;left:0;right:0;z-index:190;background:#b71c1c;color:#fff;font-family:'JetBrains Mono',monospace;font-size:.7rem;text-align:center;padding:5px;display:none}
    #offline-bar.show{display:block}
    /* Frame */
    #frame-wrap{position:fixed;top:52px;left:0;right:0;bottom:0;z-index:10;overflow:hidden}
    #pull-indicator{position:absolute;top:0;left:50%;transform:translateX(-50%) translateY(-60px);width:36px;height:36px;border-radius:50%;background:var(--card);border:1px solid var(--border);display:none;align-items:center;justify-content:center;font-size:1.1rem;z-index:20;pointer-events:none;opacity:0}
    @keyframes spin{to{transform:translateX(-50%) translateY(8px) rotate(360deg)}}
    #pull-indicator.spinning{animation:spin .6s linear infinite;display:flex}
    #main-frame{width:100%;height:100%;border:none;display:block;opacity:0;transition:opacity .5s}
    #main-frame.loaded{opacity:1}
    /* Offline page */
    #offline-page{position:absolute;inset:0;background:var(--bg);display:none;flex-direction:column;align-items:center;justify-content:center;gap:16px;z-index:15;padding:24px;text-align:center}
    #offline-page.show{display:flex}
    .offline-icon{font-size:3.5rem}.offline-title{font-size:1.4rem;font-weight:700}
    .offline-sub{font-family:'JetBrains Mono',monospace;font-size:.75rem;color:var(--muted);line-height:1.6}
    .offline-card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:16px 20px;width:100%;max-width:320px;text-align:left}
    .offline-card-title{font-family:'JetBrains Mono',monospace;font-size:.65rem;color:var(--muted);text-transform:uppercase;margin-bottom:10px}
    .offline-row{display:flex;justify-content:space-between;font-size:.9rem;margin-bottom:6px}
    .offline-row:last-child{margin-bottom:0}
    .offline-val{font-weight:700;color:var(--accent)}.offline-val.warn{color:var(--warn)}.offline-val.err{color:#ff5252}
    .offline-retry{margin-top:8px;padding:10px 24px;background:linear-gradient(135deg,var(--accent),#00b300);border:none;border-radius:100px;color:#000;font-family:'Rajdhani',sans-serif;font-size:.95rem;font-weight:700;cursor:pointer}
    /* Onboarding */
    #onboarding{position:fixed;inset:0;z-index:8888;background:var(--bg);display:flex;flex-direction:column;align-items:center;justify-content:center;padding:32px 24px}
    #onboarding.done{display:none}
    .ob-slide{display:none;flex-direction:column;align-items:center;text-align:center;max-width:320px;width:100%}
    .ob-slide.active{display:flex;animation:fadeSlide .35s ease}
    @keyframes fadeSlide{from{opacity:0;transform:translateX(24px)}to{opacity:1;transform:translateX(0)}}
    .ob-emoji{font-size:4rem;margin-bottom:20px}
    .ob-title{font-size:1.5rem;font-weight:700;margin-bottom:14px;background:linear-gradient(90deg,var(--accent),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .ob-desc{font-family:'JetBrains Mono',monospace;font-size:.78rem;color:var(--muted);line-height:1.75;max-width:280px}
    .ob-desc strong{color:var(--text)}
    .ob-dots{display:flex;gap:8px;margin:28px 0 22px}
    .ob-dot{width:8px;height:8px;border-radius:50%;background:var(--muted);transition:all .3s}
    .ob-dot.active{background:var(--accent);width:24px;border-radius:4px}
    .ob-btn{padding:13px 40px;background:linear-gradient(135deg,var(--accent),#00b300);border:none;border-radius:100px;color:#000;font-family:'Rajdhani',sans-serif;font-size:1rem;font-weight:700;cursor:pointer;transition:transform .2s,box-shadow .2s}
    .ob-btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,230,118,.35)}
    .ob-skip{background:none;border:none;color:var(--muted);font-family:'JetBrains Mono',monospace;font-size:.7rem;cursor:pointer;margin-top:14px;text-decoration:underline;padding:4px}
    /* Panel */
    #notif-panel{position:fixed;top:60px;right:12px;z-index:500;width:min(330px,92vw);background:var(--card);border:1px solid var(--border);border-radius:16px;padding:18px;box-shadow:0 16px 48px rgba(0,0,0,.75);transform:translateY(-20px) scale(.95);opacity:0;pointer-events:none;transition:all .3s cubic-bezier(.34,1.56,.64,1);max-height:calc(100vh - 80px);overflow-y:auto}
    #notif-panel.open{transform:translateY(0) scale(1);opacity:1;pointer-events:all}
    .np-title{font-size:1rem;font-weight:700;margin-bottom:14px}
    .np-label{font-family:'JetBrains Mono',monospace;font-size:.63rem;color:var(--muted);letter-spacing:.1em;margin-bottom:6px;text-transform:uppercase}
    .np-section{margin-bottom:12px}
    .np-input{width:100%;padding:9px 12px;border-radius:9px;background:rgba(0,230,118,.05);border:1px solid var(--border);color:var(--text);font-family:'JetBrains Mono',monospace;font-size:.8rem;outline:none;transition:border .2s}
    .np-input:focus{border-color:var(--accent)}
    .np-btn{width:100%;padding:10px;border-radius:10px;border:none;font-family:'Rajdhani',sans-serif;font-size:.95rem;font-weight:700;cursor:pointer;transition:all .2s;margin-bottom:8px}
    .np-btn-green{background:linear-gradient(135deg,var(--accent),#00b300);color:#000}
    .np-btn-green:hover{box-shadow:0 0 20px rgba(0,230,118,.4);transform:translateY(-1px)}
    .np-btn-blue{background:rgba(0,176,255,.1);border:1px solid rgba(0,176,255,.25);color:var(--accent2)}
    .np-btn-red{background:rgba(255,23,68,.08);border:1px solid rgba(255,23,68,.25);color:#ff6b6b}
    .np-btn-cache{background:rgba(120,120,120,.08);border:1px solid rgba(150,150,150,.2);color:#90a4ae}
    .np-btn-cache:hover{background:rgba(255,23,68,.08);border-color:rgba(255,23,68,.25);color:#ff6b6b}

    /* ‚îÄ‚îÄ Floating support button ‚îÄ‚îÄ */
    #fab-support{position:fixed;bottom:24px;right:16px;z-index:300;width:52px;height:52px;border-radius:50%;background:linear-gradient(135deg,#0088cc,#006fa8);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:1.4rem;box-shadow:0 4px 20px rgba(0,136,204,.5);transition:transform .2s,box-shadow .2s;animation:fabIn .5s cubic-bezier(.34,1.56,.64,1) 2s both}
    #fab-support:hover{transform:scale(1.1);box-shadow:0 6px 28px rgba(0,136,204,.7)}
    #fab-support:active{transform:scale(.92)}
    @keyframes fabIn{from{transform:scale(0) rotate(-180deg);opacity:0}to{transform:scale(1) rotate(0deg);opacity:1}}
    #fab-tooltip{position:fixed;bottom:84px;right:16px;z-index:300;background:var(--card);border:1px solid var(--border);border-radius:10px;padding:7px 12px;font-family:'JetBrains Mono',monospace;font-size:.68rem;color:var(--text);white-space:nowrap;pointer-events:none;opacity:0;transform:translateY(6px);transition:all .2s;box-shadow:0 4px 16px rgba(0,0,0,.4)}
    #fab-tooltip.show{opacity:1;transform:translateY(0)}

    /* ‚îÄ‚îÄ Confetti canvas ‚îÄ‚îÄ */
    #confetti-canvas{position:fixed;inset:0;z-index:9000;pointer-events:none;display:none}
    /* Dashboard */
    .dash-card{border-radius:14px;padding:14px 16px;margin-bottom:12px;border:1px solid var(--border);background:rgba(255,255,255,.03)}
    .dash-card.ok{border-color:rgba(0,230,118,.4);background:rgba(0,230,118,.05)}
    .dash-card.warn{border-color:rgba(255,109,0,.4);background:rgba(255,109,0,.05)}
    .dash-card.err{border-color:rgba(255,23,68,.4);background:rgba(255,23,68,.05)}
    .dc-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
    .dc-lbl{font-family:'JetBrains Mono',monospace;font-size:.65rem;color:var(--muted);text-transform:uppercase;letter-spacing:.08em}
    .dc-badge{font-size:.75rem;font-weight:700;padding:2px 9px;border-radius:20px;background:rgba(0,230,118,.12);color:var(--accent)}
    .dash-card.warn .dc-badge{background:rgba(255,109,0,.12);color:var(--warn)}
    .dash-card.err .dc-badge{background:rgba(255,23,68,.12);color:#ff5252}
    .dc-days-num{font-size:2.6rem;font-weight:700;line-height:1;color:var(--accent);margin-bottom:2px}
    .dash-card.warn .dc-days-num{color:var(--warn)}.dash-card.err .dc-days-num{color:#ff5252}
    .dc-days-sub{font-family:'JetBrains Mono',monospace;font-size:.65rem;color:var(--muted)}
    .dc-meta{display:flex;gap:14px;margin-top:12px}
    .dc-meta-item{flex:1}
    .dc-meta-lbl{font-family:'JetBrains Mono',monospace;font-size:.6rem;color:var(--muted);text-transform:uppercase}
    .dc-meta-val{font-size:.82rem;font-weight:600;margin-top:2px}
    .sub-bar{height:3px;border-radius:2px;background:rgba(255,255,255,.07);margin-top:10px;overflow:hidden}
    .sub-bar-fill{height:100%;border-radius:2px;transition:width .8s ease,background .4s}
    .history-list{display:flex;flex-direction:column;gap:5px;margin-top:6px}
    .history-item{display:flex;justify-content:space-between;align-items:center;padding:7px 10px;border-radius:8px;background:rgba(0,230,118,.04);border:1px solid rgba(0,230,118,.08)}
    .history-date{font-family:'JetBrains Mono',monospace;font-size:.67rem;color:var(--muted)}
    .history-val{font-size:.75rem;color:var(--accent);font-weight:600}
    .np-hint{font-family:'JetBrains Mono',monospace;font-size:.66rem;color:var(--muted);text-align:center;margin:6px 0 10px;line-height:1.5}
    .np-divider{height:1px;background:var(--border);margin:10px 0}
    .np-status{font-family:'JetBrains Mono',monospace;font-size:.72rem;margin-top:8px;padding:8px 10px;border-radius:8px;background:rgba(0,230,118,.05);border:1px solid var(--border);display:none}
    .np-status.show{display:block}
    .np-status.ok{color:var(--accent);border-color:rgba(0,230,118,.3)}
    .np-status.warn{color:var(--warn);border-color:rgba(255,109,0,.3)}
    .np-status.err{color:#ff1744;border-color:rgba(255,23,68,.3)}
    /* Install */
    #install-banner{display:none;position:fixed;bottom:16px;left:50%;transform:translateX(-50%);background:var(--card);border:1px solid rgba(0,230,118,.25);border-radius:14px;padding:12px 16px;flex-direction:row;align-items:center;gap:12px;z-index:400;box-shadow:0 8px 32px rgba(0,0,0,.6);min-width:260px;max-width:90vw;animation:su .4s cubic-bezier(.34,1.56,.64,1)}
    @keyframes su{from{transform:translateX(-50%) translateY(80px);opacity:0}to{transform:translateX(-50%) translateY(0);opacity:1}}
    #install-banner.show{display:flex}
    .ib-icon{font-size:1.7rem}.ib-text{flex:1}
    .ib-text strong{display:block;font-size:.95rem;font-weight:700}
    .ib-text span{font-size:.7rem;color:var(--muted);font-family:'JetBrains Mono',monospace}
    .ib-install{padding:8px 16px;background:linear-gradient(135deg,var(--accent),#00b300);border:none;border-radius:100px;color:#000;font-family:'Rajdhani',sans-serif;font-size:.85rem;font-weight:700;cursor:pointer}
    .ib-close{background:none;border:none;color:var(--muted);cursor:pointer;font-size:1rem}
    #dimmer{position:fixed;inset:0;z-index:450;background:rgba(0,0,0,.5);display:none;backdrop-filter:blur(2px)}
    #dimmer.show{display:block}

    /* ‚îÄ‚îÄ Telegram chip in header ‚îÄ‚îÄ */
    #tg-chip{display:flex;align-items:center;gap:3px;padding:4px 8px;border-radius:20px;background:rgba(84,110,122,.12);border:1px solid rgba(84,110,122,.25);font-family:'JetBrains Mono',monospace;font-size:.6rem;color:var(--muted);cursor:pointer;transition:all .3s;white-space:nowrap;text-decoration:none;min-width:36px;justify-content:center}
    #tg-chip.connected{background:rgba(0,176,255,.12);border-color:rgba(0,176,255,.4);color:var(--accent2)}
    #tg-chip.connected:hover{background:rgba(0,176,255,.2)}
    #tg-chip:not(.connected):hover{background:rgba(84,110,122,.2)}
    .tg-chip-dot{width:5px;height:5px;border-radius:50%;background:var(--muted);flex-shrink:0;transition:background .3s}
    #tg-chip.connected .tg-chip-dot{background:var(--accent2);box-shadow:0 0 4px var(--accent2)}

    /* ‚îÄ‚îÄ FAB support button ‚îÄ‚îÄ */
    #fab-support{position:fixed;bottom:24px;right:18px;z-index:300;width:52px;height:52px;border-radius:50%;background:linear-gradient(135deg,#0088cc,#006daa);box-shadow:0 4px 20px rgba(0,136,204,.5);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:1.4rem;transition:transform .2s,box-shadow .2s;text-decoration:none}
    #fab-support:hover{transform:scale(1.1);box-shadow:0 6px 28px rgba(0,136,204,.7)}
    #fab-support:active{transform:scale(.95)}
    #fab-support .fab-pulse{position:absolute;inset:-4px;border-radius:50%;border:2px solid rgba(0,136,204,.4);animation:fabPulse 2s ease-out infinite}
    @keyframes fabPulse{0%{transform:scale(1);opacity:.8}100%{transform:scale(1.5);opacity:0}}
    #fab-support .fab-tooltip{position:absolute;right:60px;background:rgba(13,33,55,.95);border:1px solid rgba(0,176,255,.2);color:var(--text);padding:6px 10px;border-radius:8px;font-family:'JetBrains Mono',monospace;font-size:.65rem;white-space:nowrap;opacity:0;pointer-events:none;transition:opacity .2s;top:50%;transform:translateY(-50%)}
    #fab-support:hover .fab-tooltip{opacity:1}

    /* ‚îÄ‚îÄ Telegram connect banner ‚îÄ‚îÄ */
    #tg-banner{position:fixed;bottom:90px;left:12px;right:12px;z-index:290;background:var(--card);border:1px solid rgba(0,176,255,.3);border-radius:14px;padding:12px 14px;display:none;align-items:center;gap:12px;box-shadow:0 8px 32px rgba(0,0,0,.6);animation:bannerUp .4s cubic-bezier(.34,1.56,.64,1)}
    #tg-banner.show{display:flex}
    @keyframes bannerUp{from{transform:translateY(40px);opacity:0}to{transform:translateY(0);opacity:1}}
    .tg-banner-icon{font-size:1.8rem;flex-shrink:0}
    .tg-banner-text{flex:1;min-width:0}
    .tg-banner-text strong{display:block;font-size:.9rem;font-weight:700;margin-bottom:2px}
    .tg-banner-text span{font-family:'JetBrains Mono',monospace;font-size:.65rem;color:var(--muted)}
    .tg-banner-btn{padding:8px 14px;background:linear-gradient(135deg,#0088cc,#006daa);border:none;border-radius:100px;color:#fff;font-family:'Rajdhani',sans-serif;font-size:.85rem;font-weight:700;cursor:pointer;white-space:nowrap;flex-shrink:0;text-decoration:none;display:block}
    .tg-banner-close{background:none;border:none;color:var(--muted);cursor:pointer;font-size:1.1rem;padding:4px;flex-shrink:0}
    /* Confetti canvas */
    #confetti-canvas{position:fixed;inset:0;z-index:9000;pointer-events:none;display:none}
    /* ‚îÄ‚îÄ –ê–¥–∞–ø—Ç–∏–≤ —à–∞–ø–∫–∏ ‚îÄ‚îÄ */
    @media(max-width:360px){
      .hdr-brand{font-size:.85rem}
      #proxy-btn{max-width:76px;font-size:.52rem;padding:3px 7px}
      #tg-chip{min-width:28px;padding:3px 6px;font-size:.52rem}
      #timer-pill{padding:3px 7px;font-size:.55rem}
      .bell-btn{padding:0 7px;height:30px;font-size:.8rem}
    }
    /* Live timer glow when urgent */
    .conn-pill.urgent{border-color:rgba(255,109,0,.5);background:rgba(255,109,0,.1)}
    .conn-pill.urgent .conn-text-inner{color:var(--warn)}
    .conn-pill.expired{border-color:rgba(255,23,68,.5);background:rgba(255,23,68,.1)}
    .conn-pill.expired .conn-text-inner{color:#ff5252}
  
    #fab-support{position:fixed;bottom:24px;right:16px;z-index:300;width:52px;height:52px;border-radius:50%;background:linear-gradient(135deg,#0088cc,#005f99);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:1.4rem;box-shadow:0 4px 20px rgba(0,136,204,.5);transition:transform .2s,box-shadow .2s;-webkit-tap-highlight-color:transparent}
    #fab-support:hover{transform:scale(1.1)}
    #fab-support:active{transform:scale(.93)}
    .fab-pulse{position:absolute;inset:0;border-radius:50%;background:rgba(0,136,204,.35);animation:fabPulse 2.5s ease-out infinite}
    @keyframes fabPulse{0%{transform:scale(1);opacity:.7}100%{transform:scale(1.9);opacity:0}}
    #fab-tooltip{position:absolute;right:60px;top:50%;transform:translateY(-50%);background:var(--card);border:1px solid var(--border);border-radius:8px;padding:5px 10px;font-family:monospace;font-size:.68rem;white-space:nowrap;opacity:0;pointer-events:none;transition:opacity .2s;color:var(--text)}
    #fab-support:hover #fab-tooltip{opacity:1}
    #confetti-canvas{position:fixed;inset:0;z-index:9000;pointer-events:none;display:none}

    #float-support{position:fixed;bottom:24px;right:16px;z-index:300;width:52px;height:52px;border-radius:50%;background:linear-gradient(135deg,#0088cc,#006aaa);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:1.4rem;box-shadow:0 4px 20px rgba(0,136,204,.5);transition:transform .2s,box-shadow .2s;animation:float-bob 3s ease-in-out infinite}
    #float-support:hover{transform:scale(1.12) translateY(-3px)!important;box-shadow:0 8px 28px rgba(0,136,204,.7)}
    @keyframes float-bob{0%,100%{transform:translateY(0)}50%{transform:translateY(-5px)}}
    #float-tooltip{position:fixed;bottom:84px;right:16px;z-index:301;background:var(--card);border:1px solid var(--border);border-radius:10px;padding:6px 12px;font-family:'JetBrains Mono',monospace;font-size:.7rem;color:var(--text);white-space:nowrap;opacity:0;pointer-events:none;transform:translateY(4px);transition:all .25s;box-shadow:0 4px 16px rgba(0,0,0,.4)}
    #float-support:hover+#float-tooltip{opacity:1;transform:translateY(0)}

    /* ‚îÄ‚îÄ –ü—Ä–æ–∫—Å–∏ –∫–Ω–æ–ø–∫–∞ –≤ —à–∞–ø–∫–µ ‚îÄ‚îÄ */
    #proxy-btn{display:flex;align-items:center;gap:4px;padding:4px 9px;border-radius:20px;background:rgba(255,50,50,.08);border:1px solid rgba(255,70,70,.35);font-family:'JetBrains Mono',monospace;font-size:.58rem;color:rgba(255,90,90,.9);cursor:pointer;transition:all .3s;white-space:nowrap;flex-shrink:0;line-height:1;max-width:100px;overflow:hidden;text-overflow:ellipsis}
    #proxy-btn:hover{background:rgba(255,50,50,.15);color:#ff7070}
    #proxy-btn.active{background:rgba(0,230,118,.1);border-color:rgba(0,230,118,.4);color:var(--accent)}
    #proxy-btn-dot{width:5px;height:5px;border-radius:50%;background:rgba(255,80,80,.8);flex-shrink:0;transition:all .3s;box-shadow:0 0 4px rgba(255,60,60,.5)}
    #proxy-btn.active #proxy-btn-dot{background:var(--accent);box-shadow:0 0 5px var(--accent)}
    /* ‚îÄ‚îÄ Proxy Modal ‚îÄ‚îÄ */
    #proxy-modal{position:fixed;inset:0;z-index:6000;display:none;align-items:flex-end;justify-content:center}
    #proxy-modal.show{display:flex}
    #proxy-modal-bg{position:absolute;inset:0;background:rgba(0,0,0,.7);backdrop-filter:blur(4px)}
    #proxy-modal-box{position:relative;z-index:1;width:100%;max-width:480px;background:var(--card);border-radius:24px 24px 0 0;padding:24px 20px 36px;max-height:88vh;overflow-y:auto;animation:slideUp .35s cubic-bezier(.34,1.56,.64,1)}
    .pm-handle{width:36px;height:4px;border-radius:2px;background:rgba(255,255,255,.15);margin:0 auto 20px}
    .pm-title{font-size:1.15rem;font-weight:700;margin-bottom:4px}
    .pm-sub{font-family:'JetBrains Mono',monospace;font-size:.65rem;color:var(--muted);margin-bottom:18px}
    .pm-active-card{background:rgba(0,230,118,.07);border:1px solid rgba(0,230,118,.3);border-radius:14px;padding:16px;margin-bottom:14px}
    .pm-active-status{display:flex;align-items:center;gap:8px;margin-bottom:10px}
    .pm-active-dot{width:8px;height:8px;border-radius:50%;background:var(--accent);box-shadow:0 0 8px var(--accent)}
    .pm-active-label{font-size:.95rem;font-weight:700;color:var(--accent)}
    .pm-active-note{font-size:.8rem;color:var(--muted);line-height:1.6;margin-bottom:14px}
    .pm-connect-btn{width:100%;padding:13px;background:linear-gradient(135deg,#0088cc,#006daa);border:none;border-radius:100px;color:#fff;font-family:'Rajdhani',sans-serif;font-size:1rem;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;transition:transform .2s,box-shadow .2s}
    .pm-connect-btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,136,204,.4)}
    .pm-order-card{background:rgba(255,109,0,.05);border:1px solid rgba(255,109,0,.2);border-radius:14px;padding:16px;margin-bottom:14px}
    .pm-price{font-size:1.5rem;font-weight:700;color:var(--warn);margin-bottom:4px}
    .pm-price-period{font-family:'JetBrains Mono',monospace;font-size:.62rem;color:var(--muted);margin-bottom:10px}
    .pm-order-btn{width:100%;padding:13px;background:linear-gradient(135deg,var(--warn),#cc5500);border:none;border-radius:100px;color:#fff;font-family:'Rajdhani',sans-serif;font-size:1rem;font-weight:700;cursor:pointer;margin-top:4px;transition:transform .2s}
    .pm-order-btn:hover{transform:translateY(-2px)}
    .pm-rules{background:rgba(255,255,255,.03);border:1px solid var(--border);border-radius:12px;padding:14px;margin-top:14px}
    .pm-rules-title{font-family:'JetBrains Mono',monospace;font-size:.62rem;color:var(--muted);text-transform:uppercase;letter-spacing:.08em;margin-bottom:10px}
    .pm-rule{display:flex;gap:10px;margin-bottom:7px;font-size:.82rem;line-height:1.5}
    .pm-rule:last-child{margin-bottom:0}
    .pm-rule-icon{flex-shrink:0}
    .pm-rule-warn{color:#ff5252}
</style>
</head>
<body>
<canvas id="confetti-canvas"></canvas>
<canvas id="bg-canvas"></canvas>
<canvas id="confetti-canvas"></canvas>

<!-- ONBOARDING -->
<div id="onboarding">
  <div class="ob-slide active">
    <div class="ob-emoji">‚ö°</div>
    <div class="ob-title">Weltkind</div>
    <div class="ob-desc">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!<br><br>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∞—à–µ–π <strong>–ø–æ–¥–ø–∏—Å–∫–æ–π</strong> ‚Äî –±—ã—Å—Ç—Ä–æ –∏ —É–¥–æ–±–Ω–æ –ø—Ä—è–º–æ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞.</div>
  </div>
  <div class="ob-slide">
    <div class="ob-emoji">üì±</div>
    <div class="ob-title">–í–æ–π–¥–∏—Ç–µ –ø–æ –Ω–æ–º–µ—Ä—É</div>
    <div class="ob-desc">–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ <strong>79161234567</strong><br><br>–°–∏—Å—Ç–µ–º–∞ –Ω–∞–π–¥—ë—Ç –≤–∞—à—É –ø–æ–¥–ø–∏—Å–∫—É –∏ –ø–æ–∫–∞–∂–µ—Ç —Å—Ç–∞—Ç—É—Å.</div>
  </div>
  <div class="ob-slide">
    <div class="ob-emoji">‚öôÔ∏è</div>
    <div class="ob-title">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
    <div class="ob-desc">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É <strong>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</strong> –≤ –ø—Ä–∞–≤–æ–º —É–≥–ª—É –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ Telegram-–±–æ—Ç–∞.<br><br>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏–¥—ë—Ç <strong>–∑–∞ 3 –¥–Ω—è</strong> –¥–æ –∫–æ–Ω—Ü–∞ –ø–æ–¥–ø–∏—Å–∫–∏.</div>
  </div>
  <div class="ob-dots">
    <div class="ob-dot active"></div><div class="ob-dot"></div><div class="ob-dot"></div>
  </div>
  <button class="ob-btn" id="ob-next-btn" onclick="obNext()">–î–∞–ª–µ–µ ‚Üí</button>
  <button class="ob-skip" onclick="obFinish()">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
</div>

<!-- SPLASH -->
<div id="splash">
  <canvas id="wire-canvas" width="200" height="200"></canvas>
  <div class="splash-brand">WELTKIND</div>
  <div class="splash-sub">SECURE ¬∑ PRIVATE ¬∑ FAST</div>
  <div class="splash-bar"><div class="splash-bar-fill"></div></div>
</div>

<!-- HEADER -->
<header id="hdr">
  <div class="hdr-brand">‚ö° Weltkind</div>
  <div class="hdr-right">
    <button id="proxy-btn" onclick="openProxyModal()" title="Telegram –±–µ–∑ VPN">
      <div id="proxy-btn-dot"></div>
      <span id="proxy-btn-text">TG –±–µ–∑ VPN</span>
    </button>
    <a id="tg-chip" href="#" onclick="return fabTelegramClick(event)" title="Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è">
      <div class="tg-chip-dot"></div>
      <span id="tg-chip-text">TG</span>
    </a>
    <div id="timer-pill" onclick="haptic();togglePanel()">
      <div class="t-dot" id="t-dot"></div>
      <span id="timer-text">–∑–∞–≥—Ä—É–∑–∫–∞...</span>
    </div>
    <div class="bell-btn" onclick="haptic();togglePanel()" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ø–æ–¥–ø–∏—Å–∫–∞">
      <span>‚öôÔ∏è</span>
      <span class="bell-label">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
      <div class="bell-badge" id="bell-badge"></div>
    </div>
  </div>
</header>

<div id="offline-bar">üì° –ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è ‚Äî –ø–æ–∫–∞–∑–∞–Ω—ã –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</div>
<div id="dimmer" onclick="closePanel()"></div>

<!-- PANEL -->
<div id="notif-panel">
  <div class="np-title">üìä –ú–æ—è –ø–æ–¥–ø–∏—Å–∫–∞</div>
  <div id="dash-card" class="dash-card">
    <div class="dc-head">
      <span class="dc-lbl">Weltkind</span>
      <span class="dc-badge" id="dc-badge">‚Äî</span>
    </div>
    <div class="dc-days-num" id="dc-days">‚Äî</div>
    <div class="dc-days-sub" id="dc-days-sub">–¥–Ω–µ–π –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è</div>
    <div class="dc-meta">
      <div class="dc-meta-item">
        <div class="dc-meta-lbl">–ò—Å—Ç–µ–∫–∞–µ—Ç</div>
        <div class="dc-meta-val" id="dc-expiry">‚Äî</div>
      </div>
      <div class="dc-meta-item">
        <div class="dc-meta-lbl">–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ</div>
        <div class="dc-meta-val" id="dc-synced">‚Äî</div>
      </div>
    </div>
    <div class="sub-bar"><div class="sub-bar-fill" id="sub-fill" style="width:0%"></div></div>
  </div>
  <div id="np-hint" class="np-hint">‚¨áÔ∏è –í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç ‚Äî –¥–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</div>
  <div id="history-section" style="display:none">
    <div class="np-label">üìã –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–¥–ª–µ–Ω–∏–π</div>
    <div class="history-list" id="history-list"></div>
    <div style="height:8px"></div>
  </div>
  <div class="np-divider"></div>
  <button class="np-btn np-btn-blue" onclick="haptic();shareApp()">üîó –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º</button>
  <button class="np-btn np-btn-red" id="notif-off-btn" onclick="haptic();disableNotif()" style="display:none">üîï –û—Ç–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</button>
  <div class="np-divider"></div>
  <div class="np-section">
    <div class="np-label">–í–≤–µ—Å—Ç–∏ –¥–∞—Ç—É –≤—Ä—É—á–Ω—É—é</div>
    <input type="date" id="np-date" class="np-input"/>
  </div>
  <button class="np-btn np-btn-green" onclick="haptic('medium');saveNotif()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞—Ç—É</button>
  <button class="np-btn np-btn-blue" onclick="haptic();testNotif()">üß™ –¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</button>
  <div id="np-status" class="np-status"></div>
  <div class="np-divider"></div>
  <button class="np-btn np-btn-cache" onclick="haptic('medium');clearAllCache()">‚öôÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à</button>
</div>

<!-- FRAME -->
<div id="frame-wrap">
  <div id="pull-indicator">üîÑ</div>
  <div id="offline-page">
    <div class="offline-icon">üì°</div>
    <div class="offline-title">–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</div>
    <div class="offline-sub">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç.<br>–ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Äî –Ω–∏–∂–µ.</div>
    <div class="offline-card" id="ol-card" style="display:none">
      <div class="offline-card-title">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ</div>
      <div class="offline-row"><span>–°—Ç–∞—Ç—É—Å</span><span class="offline-val" id="ol-status">‚Äî</span></div>
      <div class="offline-row"><span>–ò—Å—Ç–µ–∫–∞–µ—Ç</span><span class="offline-val" id="ol-expiry">‚Äî</span></div>
      <div class="offline-row"><span>–û—Å—Ç–∞–ª–æ—Å—å</span><span class="offline-val" id="ol-days">‚Äî</span></div>
    </div>
    <button class="offline-retry" onclick="haptic();retryConn()">üîÑ –ü–æ–≤—Ç–æ—Ä–∏—Ç—å</button>
  </div>
  <iframe id="main-frame"
    src="https://script.google.com/macros/s/AKfycbxfUBsBIMK6qULmIlqfxoOR9bWtjmc4uofYt3jWjGMd0Ql8kL4u32a7I9cgl22N3pJt8g/exec"
    title="Weltkind"
    sandbox="allow-scripts allow-same-origin allow-forms allow-popups allow-top-navigation allow-modals">
  </iframe>
</div>

<div id="install-banner">
  <div class="ib-icon">üì≤</div>
  <div class="ib-text"><strong>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</strong><span>–†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –Ω–∞—Ç–∏–≤–Ω–æ–µ</span></div>
  <button class="ib-install" id="install-btn">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
  <button class="ib-close" onclick="document.getElementById('install-banner').classList.remove('show')">‚úï</button>
</div>

<script>
/* MATRIX */
(function(){
  const c=document.getElementById('bg-canvas'),ctx=c.getContext('2d');
  let cols,drops;const chars='01„Ç¢„Ç§„Ç¶„Ç®„Ç™„Ç´„Ç≠„ÇØ„Ç±';
  function resize(){c.width=innerWidth;c.height=innerHeight;cols=Math.floor(c.width/18);drops=Array(cols).fill(1);}
  function draw(){ctx.fillStyle='rgba(5,13,20,.06)';ctx.fillRect(0,0,c.width,c.height);ctx.fillStyle='#00e676';ctx.font='13px monospace';for(let i=0;i<drops.length;i++){ctx.fillText(chars[Math.floor(Math.random()*chars.length)],i*18,drops[i]*18);if(drops[i]*18>c.height&&Math.random()>.975)drops[i]=0;drops[i]++;}}
  resize();window.addEventListener('resize',resize);setInterval(draw,55);
})();


/* ‚ïê‚ïê‚ïê‚ïê WIRE SPLASH ANIMATION ‚ïê‚ïê‚ïê‚ïê */
(function(){
  const cv = document.getElementById('wire-canvas');
  if(!cv) return;
  const ctx = cv.getContext('2d');
  const W = 200, H = 200, CX = 100, CY = 100;
  cv.width = W; cv.height = H;

  // –ö–∞–∂–¥—ã–π –ø—Ä–æ–≤–æ–¥: –ª–µ–≤—ã–π –∫–æ–Ω–µ—Ü (–æ–±–æ—Ä–≤–∞–Ω–Ω—ã–π) –∏ –ø—Ä–∞–≤—ã–π –∫–æ–Ω–µ—Ü (–æ–±–æ—Ä–≤–∞–Ω–Ω—ã–π), –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ —Ü–µ–Ω—Ç—Ä–µ
  const NUM = 6;
  let t = 0;
  let connected = false;
  let connectTime = 0;
  let sparkLife = 0;
  let rafId;

  // –ü—Ä–æ–≤–æ–¥–∞: —É–≥–æ–ª, –¥–ª–∏–Ω–∞ –¥–æ —Ü–µ–Ω—Ç—Ä–∞, —Å–º–µ—â–µ–Ω–∏–µ y-–∫–æ–Ω—Ü–∞, —Ü–≤–µ—Ç
  const wires = Array.from({length: NUM}, (_, i) => {
    const angle = (Math.PI * 2 / NUM) * i;
    const r = 72 + (i % 3) * 8;
    // –û–±–æ—Ä–≤–∞–Ω–Ω—ã–π –∫–æ–Ω–µ—Ü: –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–Ω–∞—Ä—É–∂–∏, –∏–¥—ë—Ç –∫ —Ü–µ–Ω—Ç—Ä—É
    return {
      angle,
      r,
      color: i % 2 === 0 ? '#00e676' : '#00b0ff',
      // —Å–ª—É—á–∞–π–Ω–æ–µ "–¥—Ä–æ–∂–∞–Ω–∏–µ" –æ–±–æ—Ä–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ü–∞
      jitter: Math.random() * Math.PI * 2,
      jitterSpeed: 0.08 + Math.random() * 0.06,
      thickness: 2 + (i % 3),
      progress: 0, // 0 ‚Üí 1: –ø—Ä–æ–≤–æ–¥ "–ø–æ–ª–∑—ë—Ç" –∫ —Ü–µ–Ω—Ç—Ä—É
      phase: i * 0.18, // –∑–∞–¥–µ—Ä–∂–∫–∞ —Å—Ç–∞—Ä—Ç–∞
    };
  });

  // –¢–æ—á–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –≤ —Ü–µ–Ω—Ç—Ä–µ ‚Äî –º–∞–ª–µ–Ω—å–∫–∏–π —Ä–∞–∑—ä—ë–º
  function drawConnector(alpha) {
    ctx.save();
    ctx.globalAlpha = alpha;
    // Outer glow
    const grd = ctx.createRadialGradient(CX,CY,0, CX,CY,22);
    grd.addColorStop(0,'rgba(0,230,118,0.9)');
    grd.addColorStop(0.4,'rgba(0,230,118,0.4)');
    grd.addColorStop(1,'rgba(0,230,118,0)');
    ctx.beginPath(); ctx.arc(CX,CY,22,0,Math.PI*2);
    ctx.fillStyle = grd; ctx.fill();
    // Core circle
    ctx.beginPath(); ctx.arc(CX,CY,7,0,Math.PI*2);
    ctx.fillStyle = '#00e676'; ctx.shadowColor='#00e676'; ctx.shadowBlur=14;
    ctx.fill();
    // Ring
    ctx.beginPath(); ctx.arc(CX,CY,11,0,Math.PI*2);
    ctx.strokeStyle='rgba(0,230,118,0.7)'; ctx.lineWidth=1.5;
    ctx.stroke();
    ctx.restore();
  }

  function drawSpark(x, y, color, life) {
    const sparks = 8;
    ctx.save();
    for(let i=0;i<sparks;i++){
      const a = (Math.PI*2/sparks)*i + life*3;
      const len = (4 + Math.random()*10) * life;
      ctx.beginPath();
      ctx.moveTo(x, y);
      ctx.lineTo(x + Math.cos(a)*len, y + Math.sin(a)*len);
      ctx.strokeStyle = i%2===0 ? '#00e676' : '#fff176';
      ctx.lineWidth = 1.5 * life;
      ctx.globalAlpha = life * 0.9;
      ctx.shadowColor = '#00e676';
      ctx.shadowBlur = 6;
      ctx.stroke();
    }
    ctx.restore();
  }

  function easeInOut(t){ return t<0.5 ? 2*t*t : -1+(4-2*t)*t; }

  function draw() {
    ctx.clearRect(0, 0, W, H);
    t += 0.016;

    // Advance each wire progress
    wires.forEach((w, i) => {
      const startT = w.phase * 2.2;
      if(t > startT) {
        const elapsed = t - startT;
        w.progress = Math.min(1, elapsed / 1.4);
      }
    });

    const allConnected = wires.every(w => w.progress >= 1);
    if(allConnected && !connected) {
      connected = true;
      connectTime = t;
      sparkLife = 1;
    }
    if(connected) {
      sparkLife = Math.max(0, 1 - (t - connectTime) / 1.2);
    }

    // Draw each wire
    wires.forEach((w) => {
      if(w.progress <= 0) return;

      const tip = easeInOut(w.progress);
      // Wire goes from outer point inward toward center
      const startX = CX + Math.cos(w.angle) * w.r;
      const startY = CY + Math.sin(w.angle) * w.r;

      // Current tip position (moving toward center)
      const tipX = startX + (CX - startX) * tip;
      const tipY = startY + (CY - startY) * tip;

      // Draw wire body with slight curve (torn wire effect)
      ctx.save();
      ctx.beginPath();
      // Control point offset for torn/bent look
      const bend = Math.sin(w.angle + 1.2) * 18 * (1 - tip * 0.7);
      const cpX = (startX + tipX) / 2 + Math.cos(w.angle + Math.PI/2) * bend;
      const cpY = (startY + tipY) / 2 + Math.sin(w.angle + Math.PI/2) * bend;
      ctx.moveTo(startX, startY);
      ctx.quadraticCurveTo(cpX, cpY, tipX, tipY);

      // Glow effect
      ctx.shadowColor = w.color;
      ctx.shadowBlur = 8;
      ctx.strokeStyle = w.color;
      ctx.lineWidth = w.thickness;
      ctx.lineCap = 'round';
      ctx.globalAlpha = 0.9;
      ctx.stroke();

      // Wire insulation (darker inner line)
      ctx.beginPath();
      ctx.moveTo(startX, startY);
      ctx.quadraticCurveTo(cpX, cpY, tipX, tipY);
      ctx.strokeStyle = 'rgba(0,0,0,0.5)';
      ctx.lineWidth = w.thickness - 1;
      ctx.shadowBlur = 0;
      ctx.globalAlpha = 0.4;
      ctx.stroke();

      // Torn/frayed end ‚Äî small sparks at tip if not yet connected
      if(w.progress < 1) {
        const jitter = Math.sin(t * 12 + w.jitter) * 3;
        const jitter2 = Math.cos(t * 15 + w.jitter) * 2;
        for(let s = 0; s < 3; s++) {
          const sx = tipX + (Math.random()-0.5)*6;
          const sy = tipY + (Math.random()-0.5)*6;
          ctx.beginPath();
          ctx.moveTo(tipX + jitter, tipY + jitter2);
          ctx.lineTo(sx, sy);
          ctx.strokeStyle = s===1 ? '#fff' : w.color;
          ctx.lineWidth = 0.8;
          ctx.globalAlpha = 0.6 + Math.random()*0.4;
          ctx.shadowColor = w.color;
          ctx.shadowBlur = 4;
          ctx.stroke();
        }
      }

      ctx.restore();
    });

    // Connector in center
    const connAlpha = Math.min(1, Math.max(...wires.map(w=>w.progress)));
    if(connAlpha > 0) drawConnector(connAlpha);

    // Connection spark burst
    if(connected && sparkLife > 0) {
      drawSpark(CX, CY, '#00e676', sparkLife);
    }

    // Pulse rings after connection
    if(connected) {
      const age = t - connectTime;
      for(let r = 0; r < 3; r++) {
        const rAge = (age - r*0.25);
        if(rAge <= 0) continue;
        const rad = rAge * 35;
        const alpha = Math.max(0, 0.6 - rAge * 0.5);
        if(alpha <= 0) continue;
        ctx.save();
        ctx.beginPath();
        ctx.arc(CX, CY, rad, 0, Math.PI*2);
        ctx.strokeStyle = '#00e676';
        ctx.lineWidth = 1.5;
        ctx.globalAlpha = alpha;
        ctx.shadowColor = '#00e676';
        ctx.shadowBlur = 8;
        ctx.stroke();
        ctx.restore();
      }
    }

    rafId = requestAnimationFrame(draw);
    // Stop after splash fades
    if(document.getElementById('splash').classList.contains('out')) {
      cancelAnimationFrame(rafId);
    }
  }

  draw();
})();

/* Telegram WebView detection */
const isTgWebView = /Telegram|TelegramBrowser/i.test(navigator.userAgent) || !!window.TelegramWebApp || !!window.Telegram;

/* HAPTIC */
function haptic(t='light'){
  if(!navigator.vibrate)return;
  ({light:[8],medium:[15],heavy:[25,10,25],success:[10,50,10,50,20]})[t]&&navigator.vibrate(({light:[8],medium:[15],heavy:[25,10,25],success:[10,50,10,50,20]})[t]);
}

/* CONFETTI */
const cc=document.getElementById('confetti-canvas'),ccx=cc.getContext('2d');
let cp=[],ca=null;
function launchConfetti(){
  cc.width=innerWidth;cc.height=innerHeight;cc.style.display='block';
  const colors=['#00e676','#00b0ff','#ff6d00','#e040fb','#ffeb3b','#ff4081'];
  cp=Array.from({length:160},()=>({
    x:Math.random()*innerWidth,y:-10-Math.random()*innerHeight*.3,
    w:6+Math.random()*8,h:4+Math.random()*6,
    color:colors[Math.floor(Math.random()*colors.length)],
    vx:(Math.random()-.5)*4,vy:2+Math.random()*5,
    rot:Math.random()*360,rotV:(Math.random()-.5)*6,opacity:1
  }));
  if(ca)cancelAnimationFrame(ca);
  animC();haptic('success');
  setTimeout(()=>{cc.style.display='none';cp=[];},4500);
}
function animC(){
  ccx.clearRect(0,0,cc.width,cc.height);
  let alive=false;
  cp.forEach(p=>{
    p.x+=p.vx;p.y+=p.vy;p.rot+=p.rotV;p.vy+=0.12;
    if(p.y>innerHeight*.75)p.opacity-=0.025;
    if(p.opacity>0)alive=true;
    ccx.save();ccx.globalAlpha=Math.max(0,p.opacity);
    ccx.translate(p.x,p.y);ccx.rotate(p.rot*Math.PI/180);
    ccx.fillStyle=p.color;ccx.fillRect(-p.w/2,-p.h/2,p.w,p.h);
    ccx.restore();
  });
  if(alive)ca=requestAnimationFrame(animC);else cc.style.display='none';
}

/* ONBOARDING */
let obIdx=0;
function obInit(){if(_lsGet('onboarded'))document.getElementById('onboarding').classList.add('done');}
function obNext(){
  haptic();obIdx++;
  if(obIdx>=3){obFinish();return;}
  document.querySelectorAll('.ob-slide').forEach((s,i)=>s.classList.toggle('active',i===obIdx));
  document.querySelectorAll('.ob-dot').forEach((d,i)=>d.classList.toggle('active',i===obIdx));
  if(obIdx===2)document.getElementById('ob-next-btn').textContent='–ù–∞—á–∞—Ç—å ‚Üí';
}
function obFinish(){haptic('medium');_lsSet('onboarded','1');document.getElementById('onboarding').classList.add('done');}

/* IFRAME */
const frame=document.getElementById('main-frame');
let sT=setTimeout(()=>{
  document.getElementById('splash').classList.add('out');
  // –í Telegram WebView iframe –º–æ–∂–µ—Ç –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
  if(isTgWebView && !frame.classList.contains('loaded')){
    showTgOpenBrowser();
  }
},9000);
frame.addEventListener('load',()=>{
  clearTimeout(sT);frame.classList.add('loaded');
  setTimeout(()=>document.getElementById('splash').classList.add('out'),400);
  startTimer();
});

function showTgOpenBrowser(){
  const fw=document.getElementById('frame-wrap');
  const op=document.getElementById('offline-page');
  op.classList.add('show');
  op.innerHTML=`
    <div class="offline-icon">üì±</div>
    <div class="offline-title">Telegram Browser</div>
    <div class="offline-sub">–î–ª—è –ø–æ–ª–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è<br>–æ—Ç–∫—Ä–æ–π—Ç–µ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ.</div>
    <button class="offline-retry" onclick="openUrl('https://weltkind666.github.io/777Weltkind777/')">üåê –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ</button>
    <div id="tg-sub-info" style="margin-top:14px;width:100%;max-width:320px"></div>
  `;
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –µ—Å—Ç—å
  const sub=loadSub();
  if(sub.date){
    const d=daysLeft(sub.date);
    const info=document.getElementById('tg-sub-info');
    if(info){info.innerHTML=`<div class="offline-card"><div class="offline-card-title">–î–∞–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏</div><div class="offline-row"><span>–°—Ç–∞—Ç—É—Å</span><span class="offline-val">${sub.status||'‚Äî'}</span></div><div class="offline-row"><span>–ò—Å—Ç–µ–∫–∞–µ—Ç</span><span class="offline-val">${new Date(sub.date).toLocaleDateString('ru-RU')}</span></div><div class="offline-row"><span>–û—Å—Ç–∞–ª–æ—Å—å</span><span class="offline-val ${d<=0?'err':d<=3?'warn':''}">${d<=0?'–∏—Å—Ç–µ–∫–ª–∞':d+' –¥–Ω.'}</span></div></div>`;}
  }
  frame.style.display='none';
}

/* SW */
let swReg=null;
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('sw.js').then(reg=>{
    swReg=reg;
    if('periodicSync' in reg)reg.periodicSync.register('check-subscription',{minInterval:86400000}).catch(()=>{});
  }).catch(()=>{});
  navigator.serviceWorker.addEventListener('message',e=>{if(e.data?.type==='bg_check')checkExpiry();});
}

/* ‚ïê‚ïê‚ïê‚ïê SW NOTIFY ‚Äî –Ω–∞—Å—Ç–æ—è—â–∏–µ –º–æ–±–∏–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ‚ïê‚ïê‚ïê‚ïê */
async function swNotify(title,body,tag='weltkind'){
  if(Notification.permission!=='granted')return;
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–≥–æ —Å–∏–Ω–∫–∞
  try{
    const sub=loadSub();
    if(sub.date){const cache=await caches.open('Weltkind-v4');await cache.put('weltkind-sub-data',new Response(JSON.stringify(sub)));}
  }catch(e){}
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ SW ‚Äî –ø—Ä–∏—Ö–æ–¥–∏—Ç –∫–∞–∫ –Ω–∞—Å—Ç–æ—è—â–∏–π –ø—É—à –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º
  const reg=swReg||await navigator.serviceWorker.getRegistration();
  if(reg?.active){
    reg.active.postMessage({type:'SHOW_NOTIFICATION',title,body,tag});
  } else {
    // Fallback –¥–µ—Å–∫—Ç–æ–ø
    try{const n=new Notification(title,{body,icon:'icons/icon-192.png',tag});n.onclick=()=>{window.focus();n.close();};}catch(e){}
  }
}

/* NETWORK */
function updateNet(){
  const on=navigator.onLine;
  document.getElementById('offline-bar').classList.toggle('show',!on);
  document.getElementById('offline-page').classList.toggle('show',!on);
  frame.style.display=on?'block':'none';
  if(!on){
    const sub=loadSub();
    if(sub.date){
      document.getElementById('ol-card').style.display='block';
      document.getElementById('ol-status').textContent=sub.status||'‚Äî';
      document.getElementById('ol-expiry').textContent=new Date(sub.date).toLocaleDateString('ru-RU');
      const d=daysLeft(sub.date);
      const el=document.getElementById('ol-days');
      el.textContent=d===null?'‚Äî':d<=0?'–∏—Å—Ç–µ–∫–ª–∞':d+' –¥–Ω.';
      el.className='offline-val'+(d!==null&&d<=0?' err':d!==null&&d<=3?' warn':'');
    }
  }
}
function retryConn(){if(navigator.onLine){updateNet();frame.src=frame.src;}}
window.addEventListener('online',updateNet);
window.addEventListener('offline',updateNet);

/* PULL-TO-REFRESH */
let ptY=0,ptD=0,ptOn=false;
const PTR=65,pin=document.getElementById('pull-indicator'),fw=document.getElementById('frame-wrap');
fw.addEventListener('touchstart',e=>{ptY=e.touches[0].clientY;ptOn=true;},{passive:true});
fw.addEventListener('touchmove',e=>{
  if(!ptOn||!navigator.onLine)return;
  ptD=e.touches[0].clientY-ptY;
  if(ptD>0&&ptD<PTR*1.8){const p=Math.min(ptD/PTR,1);pin.style.display='flex';pin.style.opacity=p;pin.style.transform=`translateX(-50%) translateY(${-60+68*p}px) rotate(${p*180}deg)`;}
},{passive:true});
fw.addEventListener('touchend',()=>{
  if(!ptOn)return;ptOn=false;
  if(ptD>=PTR&&navigator.onLine){haptic('medium');pin.classList.add('spinning');frame.src=frame.src;frame.addEventListener('load',()=>{pin.classList.remove('spinning');pin.style.opacity='0';setTimeout(()=>pin.style.display='none',400);},{once:true});}
  else{pin.style.opacity='0';setTimeout(()=>pin.style.display='none',300);}
  ptD=0;pin.style.transform='translateX(-50%) translateY(-60px)';
});

/* STORAGE ‚Äî —Å fallback –¥–ª—è Telegram WebView –≥–¥–µ localStorage –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω */
const _memStore={};
function _lsGet(k){try{const v=localStorage.getItem(k);if(v!==undefined)return v;}catch(e){}return _memStore[k]||null;}
function _lsSet(k,v){try{localStorage.setItem(k,v);}catch(e){}  _memStore[k]=v;}
function loadSub(){try{return JSON.parse(_lsGet('vpn_s')||'{}')||{};}catch(e){return{};}}
function saveSub(o){_lsSet('vpn_s',JSON.stringify(o));}
function loadHist(){try{return JSON.parse(_lsGet('vpn_hist')||'[]');}catch(e){return[];}}
function saveHist(a){_lsSet('vpn_hist',JSON.stringify(a));}

/* DATE */
function toISO(str){
  if(!str||str==='–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ'||str==='–ù–µ –æ–ø–ª–∞—á–µ–Ω–æ')return null;
  const p=str.split('.');if(p.length===3)return`${p[2]}-${p[1].padStart(2,'0')}-${p[0].padStart(2,'0')}`;
  const d=new Date(str);return isNaN(d)?null:d.toISOString().slice(0,10);
}
function daysLeft(iso){if(!iso)return null;return Math.ceil((new Date(iso)-Date.now())/86400000);}
/* BADGE */
function updateBadge(d){
  if(!('setAppBadge' in navigator))return;
  d===null?navigator.clearAppBadge().catch(()=>{}):d<=0?navigator.setAppBadge(99).catch(()=>{}):d<=30?navigator.setAppBadge(d).catch(()=>{}):navigator.clearAppBadge().catch(()=>{});
}

/* LIVE TIMER */
let timerIv=null;
function tickTimer(){
  const sub=loadSub();
  const pill=document.getElementById('timer-pill');
  const tdot=document.getElementById('t-dot');
  const ttxt=document.getElementById('timer-text');
  if(!sub||!sub.date){
    pill.className='';tdot.className='t-dot';
    ttxt.textContent=isTgWebView?'–∑–∞–≥—Ä—É–∑–∫–∞...':'–≤–æ–π–¥–∏—Ç–µ';
    updateBadge(null);return;
  }
  const msLeft=new Date(sub.date)-Date.now();
  const days=Math.floor(msLeft/86400000);
  updateBadge(days);
  if(msLeft<=0){
    pill.className='err';tdot.className='t-dot err';ttxt.textContent='–∏—Å—Ç–µ–∫–ª–∞!';
    document.getElementById('bell-badge').classList.add('show');
  } else if(days<=7){
    const h=Math.floor((msLeft%86400000)/3600000);
    const m=Math.floor((msLeft%3600000)/60000);
    const s=Math.floor((msLeft%60000)/1000);
    const pad=n=>String(n).padStart(2,'0');
    ttxt.textContent=days>0?`${days}–¥ ${pad(h)}—á ${pad(m)}–º`:`${pad(h)}:${pad(m)}:${pad(s)}`;
    pill.className=days<=3?'err':'warn';
    tdot.className=days<=3?'t-dot err':'t-dot warn';
    document.getElementById('bell-badge').classList.add('show');
  } else {
    pill.className='';tdot.className='t-dot ok';ttxt.textContent=days+' –¥–Ω.';
  }
}
function startTimer(){if(timerIv)clearInterval(timerIv);tickTimer();timerIv=setInterval(tickTimer,1000);}

/* postMessage */
window.addEventListener('message',e=>{
  if(!e.data)return;
  // –ó–∞—è–≤–∫–∞ –Ω–∞ –ø—Ä–æ–∫—Å–∏ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ ‚Äî –ø–µ—Ä–µ—Å—ã–ª–∞–µ–º –≤ Apps Script —Ñ—Ä–µ–π–º –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞
  if(e.data.type==='weltkind_proxy_order'){
    // Apps Script —Å–∞–º –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ —Å–≤–æ–π listener –≤ Index_apps_script.html
    return;
  }
  if(e.data.type!=='weltkind_sub')return;
  handleSubData(e.data.expiryDate,e.data.status,e.data.phone,e.data.telegramConnected,e.data.telegramBotUrl,e.data.proxyUrl);
});

/* HANDLE DATA */
function handleSubData(expiryDate,status,phone,telegramConnected,telegramBotUrl,proxyUrl){
  const iso=toISO(expiryDate);
  const prev=loadSub();
  let total=prev.totalDays||30;
  if(iso){const d=daysLeft(iso);if(d&&d>total)total=d;}
  const sub={date:iso,displayDate:expiryDate,status,phone,totalDays:total,syncedAt:Date.now(),tgConnected:!!telegramConnected,tgBotUrl:telegramBotUrl||'https://t.me/WeltkindVPN_bot',proxyUrl:proxyUrl||''};
  saveSub(sub);
  // –ö–æ–Ω—Ñ–µ—Ç—Ç–∏ –ø—Ä–∏ –ù–û–í–û–ô –¥–∞—Ç–µ –æ–ø–ª–∞—Ç—ã
  if(iso&&iso!==prev.date&&status==='–û–ø–ª–∞—á–µ–Ω–æ'){
    const hist=loadHist();
    if(!hist.find(h=>h.date===iso)){hist.unshift({date:iso,savedAt:Date.now()});if(hist.length>10)hist.length=10;saveHist(hist);}
    setTimeout(launchConfetti,400);
  }
  startTimer();checkExpiry();
  updateTgStatus(sub);
  updateProxyStatus(sub.proxyUrl);
  if(iso&&status==='–û–ø–ª–∞—á–µ–Ω–æ')autoAskPerm();
  if(document.getElementById('notif-panel').classList.contains('open'))renderDash();
}

/* DASHBOARD */
function renderDash(){
  const sub=loadSub(),card=document.getElementById('dash-card'),fill=document.getElementById('sub-fill');
  const hint=document.getElementById('np-hint'),histSec=document.getElementById('history-section'),offBtn=document.getElementById('notif-off-btn');
  if(!sub||!sub.date){
    card.className='dash-card';['dc-badge','dc-days','dc-expiry','dc-synced'].forEach(id=>document.getElementById(id).textContent='‚Äî');
    document.getElementById('dc-days-sub').textContent='–¥–Ω–µ–π –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è';
    fill.style.width='0%';hint.style.display='block';offBtn.style.display='none';histSec.style.display='none';return;
  }
  hint.style.display='none';offBtn.style.display='block';
  document.getElementById('dc-expiry').textContent=new Date(sub.date).toLocaleDateString('ru-RU');
  document.getElementById('dc-synced').textContent=sub.syncedAt?new Date(sub.syncedAt).toLocaleTimeString('ru-RU',{hour:'2-digit',minute:'2-digit'}):'‚Äî';
  const d=daysLeft(sub.date);
  if(d===null){card.className='dash-card';}
  else if(d<=0){card.className='dash-card err';document.getElementById('dc-badge').textContent='‚ùå –ò—Å—Ç–µ–∫–ª–∞';document.getElementById('dc-days').textContent=Math.abs(d);document.getElementById('dc-days-sub').textContent='–¥–Ω–µ–π –Ω–∞–∑–∞–¥';fill.style.width='100%';fill.style.background='#ff1744';}
  else if(d<=3){card.className='dash-card warn';document.getElementById('dc-badge').textContent='‚ö†Ô∏è –°–∫–æ—Ä–æ';document.getElementById('dc-days').textContent=d;document.getElementById('dc-days-sub').textContent='–¥–Ω—è –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è';fill.style.width=Math.round((3-d)/3*100)+'%';fill.style.background='var(--warn)';}
  else{card.className='dash-card ok';document.getElementById('dc-badge').textContent='‚úÖ –ê–∫—Ç–∏–≤–Ω–∞';document.getElementById('dc-days').textContent=d;document.getElementById('dc-days-sub').textContent='–¥–Ω–µ–π –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è';fill.style.width=Math.max(5,Math.min(100,Math.round(d/(sub.totalDays||30)*100)))+'%';fill.style.background='var(--accent)';}
  const hist=loadHist();
  if(hist.length>0){histSec.style.display='block';document.getElementById('history-list').innerHTML=hist.slice(0,4).map(h=>`<div class="history-item"><span class="history-date">${new Date(h.savedAt).toLocaleDateString('ru-RU')}</span><span class="history-val">–¥–æ ${new Date(h.date).toLocaleDateString('ru-RU')}</span></div>`).join('');}
  else histSec.style.display='none';
  if(Notification.permission==='granted')document.getElementById('bell-badge').classList.add('show');
}

/* PANEL */
function togglePanel(){
  const p=document.getElementById('notif-panel'),d=document.getElementById('dimmer');
  if(p.classList.contains('open')){closePanel();}
  else{p.classList.add('open');d.classList.add('show');renderDash();const s=loadSub();if(s.date)document.getElementById('np-date').value=s.date;}
}
function closePanel(){haptic();document.getElementById('notif-panel').classList.remove('open');document.getElementById('dimmer').classList.remove('show');}

/* SHARE */
async function shareApp(){
  const data={title:'Weltkind',text:'‚ö° –£–ø—Ä–∞–≤–ª—è–π –ø–æ–¥–ø–∏—Å–∫–æ–π –ø—Ä—è–º–æ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞!',url:'https://weltkind666.github.io/777Weltkind777/'};
  try{if(navigator.share&&navigator.canShare&&navigator.canShare(data)){await navigator.share(data);}else{await navigator.clipboard.writeText(data.url);showSt('üîó –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!','ok');}}
  catch(e){if(e.name!=='AbortError'){navigator.clipboard.writeText(data.url).catch(()=>{});showSt('üîó –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!','ok');}}
}

/* NOTIFICATIONS */
async function autoAskPerm(){
  if(Notification.permission==='default'){const p=await Notification.requestPermission();if(p==='granted'){showSt('‚úÖ –£–≤–µ–¥–æ–º–ª—é –∑–∞ 3 –¥–Ω—è –¥–æ –∫–æ–Ω—Ü–∞!','ok');document.getElementById('bell-badge').classList.add('show');}}
}
async function saveNotif(){
  const date=document.getElementById('np-date').value;if(!date){showSt('‚ö†Ô∏è –£–∫–∞–∂–∏—Ç–µ –¥–∞—Ç—É','warn');return;}
  let p=Notification.permission;if(p==='default')p=await Notification.requestPermission();
  if(p==='denied'){showSt('‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –±—Ä–∞—É–∑–µ—Ä–æ–º','err');return;}
  const sub=loadSub();sub.date=date;sub.totalDays=sub.totalDays||30;sub.savedAt=Date.now();
  saveSub(sub);startTimer();renderDash();showSt('‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!','ok');document.getElementById('bell-badge').classList.add('show');checkExpiry();
}
function disableNotif(){saveSub({});startTimer();renderDash();document.getElementById('bell-badge').classList.remove('show');document.getElementById('np-date').value='';updateBadge(null);showSt('üîï –û—Ç–∫–ª—é—á–µ–Ω–æ','warn');}
async function testNotif(){
  let p=Notification.permission;if(p==='default')p=await Notification.requestPermission();
  if(p==='denied'){showSt('‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ ‚Äî —Ä–∞–∑—Ä–µ—à–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞','err');return;}
  haptic([50]);
  setTimeout(()=>swNotify('‚úÖ Weltkind ‚Äî —Ç–µ—Å—Ç','–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç! –≠—Ç–æ –Ω–∞—Å—Ç–æ—è—â–∏–π –ø—É—à.','wpwa-test'),300);
  showSt('üì¨ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —á–µ—Ä–µ–∑ Service Worker ‚Äî –ø–æ—è–≤–∏—Ç—Å—è –∫–∞–∫ –ø—É—à-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ','ok');
}
function checkExpiry(){
  const sub=loadSub();if(!sub.date||Notification.permission!=='granted')return;
  const d=daysLeft(sub.date);if(d===null||d>3)return;
  const title=d<=0?'üö® –ü–æ–¥–ø–∏—Å–∫–∞ –∏—Å—Ç–µ–∫–ª–∞!':`‚ö†Ô∏è –ò—Å—Ç–µ–∫–∞–µ—Ç —á–µ—Ä–µ–∑ ${d} –¥–Ω.`;
  setTimeout(()=>{const n=new Notification(title,{body:d<=0?'–ü—Ä–æ–¥–ª–∏—Ç–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!':'–ó–∞–π–¥–∏—Ç–µ –∏ –ø—Ä–æ–¥–ª–∏—Ç–µ.',icon:'icons/icon-192.png',tag:'w-exp',renotify:true,vibrate:[200,100,200]});n.onclick=()=>{window.focus();n.close();};},1500);
  document.getElementById('bell-badge').classList.add('show');
}
/* ‚ïê‚ïê‚ïê‚ïê TELEGRAM STATUS ‚ïê‚ïê‚ïê‚ïê */
let tgBotUrl = 'https://t.me/WeltkindVPN_bot';

function getTgUrl(phone) {
  // –§–æ—Ä–º–∏—Ä—É–µ–º —Å—Å—ã–ª–∫—É —Å –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞ ‚Äî –∫–∞–∫ –≤ Apps Script
  const p = (phone || '').replace(/\D/g, '');
  if (p) return 'https://t.me/WeltkindVPN_bot?start=' + p;
  return 'https://t.me/WeltkindVPN_bot';
}

function updateTgStatus(sub) {
  if (!sub) sub = loadSub();
  const chip = document.getElementById('tg-chip');
  const chipText = document.getElementById('tg-chip-text');
  if (!chip) return;

  const connected = !!sub.tgConnected;
  // –°—Ç—Ä–æ–∏–º URL —Å –Ω–æ–º–µ—Ä–æ–º –∫–ª–∏–µ–Ω—Ç–∞ ‚Äî —Ç–æ—á–Ω–æ –∫–∞–∫ –≤ Apps Script
  tgBotUrl = getTgUrl(sub.phone);

  // –û–±–Ω–æ–≤–ª—è–µ–º FAB —Å—Å—ã–ª–∫—É
  const fab = document.getElementById('fab-support');
  if (fab) fab.href = tgBotUrl;

  if (connected) {
    chip.classList.add('connected');
    chipText.textContent = 'TG ‚úì';
    chip.title = 'Telegram –ø–æ–¥–∫–ª—é—á—ë–Ω ‚úÖ';
    closeTgBanner();
  } else if (sub.phone) {
    chip.classList.remove('connected');
    chipText.textContent = 'TG';
    chip.title = 'Telegram –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω ‚Äî –Ω–∞–∂–º–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è';
    if (!_ssGet('tg_banner_closed')) {
      setTimeout(() => showTgBanner(tgBotUrl), 1500);
    }
  } else {
    chip.classList.remove('connected');
    chipText.textContent = 'TG';
    chip.title = '–í–æ–π–¥–∏—Ç–µ —á—Ç–æ–±—ã –ø–æ–¥–∫–ª—é—á–∏—Ç—å Telegram';
  }
}

function fabTelegramClick(e) {
  e.preventDefault();
  haptic([30]);
  const sub = loadSub();
  const url = getTgUrl(sub.phone);
  openUrl(url);
  return false;
}

function showTgBanner(url) {
  const banner = document.getElementById('tg-banner');
  const btn = document.getElementById('tg-banner-btn');
  if (!banner) return;
  // URL —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–æ–º–µ—Ä –∫–ª–∏–µ–Ω—Ç–∞
  const sub = loadSub();
  btn.href = url || getTgUrl(sub.phone);
  btn.target = '_blank';
  banner.classList.add('show');
  // –ê–≤—Ç–æ—Å–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 12 —Å–µ–∫
  setTimeout(() => banner.classList.remove('show'), 12000);
}

function closeTgBanner() {
  const banner = document.getElementById('tg-banner');
  if (banner) banner.classList.remove('show');
  try{sessionStorage.setItem('tg_banner_closed', '1');}catch(e){_memStore['ss_tg_banner_closed']='1';}
}
function _ssGet(k){try{return sessionStorage.getItem(k);}catch(e){return _memStore['ss_'+k]||null;}}

/* ‚ïê‚ïê‚ïê‚ïê PROXY TELEGRAM ‚ïê‚ïê‚ïê‚ïê */
let currentProxyUrl = '';

function updateProxyStatus(proxyUrl) {
  currentProxyUrl = proxyUrl || '';
  const btn = document.getElementById('proxy-btn');
  const btnText = document.getElementById('proxy-btn-text');
  if (!btn) return;
  // –ö–Ω–æ–ø–∫–∞ –í–°–ï–ì–î–ê –≤–∏–¥–∏–º–∞ ‚Äî –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç phone
  if (currentProxyUrl) {
    btn.className = 'active';
    btnText.textContent = 'SOCKS5 –¥–ª—è TG';
  } else {
    btn.className = '';
    btnText.textContent = 'TG –±–µ–∑ VPN';
  }
}

function openProxyModal() {
  haptic([30]);
  const sub = loadSub();
  document.getElementById('pm-active').style.display = 'none';
  document.getElementById('pm-order').style.display = 'none';
  document.getElementById('pm-noauth').style.display = 'none';
  if (!sub.phone) {
    document.getElementById('pm-noauth').style.display = 'block';
  } else if (currentProxyUrl) {
    document.getElementById('pm-active').style.display = 'block';
    document.getElementById('pm-connect-link').href = currentProxyUrl;
  } else {
    document.getElementById('pm-order').style.display = 'block';
  }
  document.getElementById('proxy-modal').classList.add('show');
}

function closeProxyModal() {
  document.getElementById('proxy-modal').classList.remove('show');
}

function orderProxy() {
  haptic([30,20,60]);
  const sub = loadSub();
  const phone = sub.phone || '';
  if (!phone) { showSt('–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç', 'err'); return; }

  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ Apps Script ‚Äî —Ç–æ–∫–µ–Ω —Å–∫—Ä—ã—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
  const appsScriptUrl = 'https://script.google.com/macros/s/AKfycbxfUBsBIMK6qULmIlqfxoOR9bWtjmc4uofYt3jWjGMd0Ql8kL4u32a7I9cgl22N3pJt8g/exec';
  fetch(appsScriptUrl + '?action=proxy_order&phone=' + encodeURIComponent(phone))
    .catch(() => {});

  closeProxyModal();
  setTimeout(showProxyOrderConfirm, 150);
}

function showProxyOrderConfirm() {
  const modal = document.getElementById('proxy-modal');
  const box = document.getElementById('proxy-modal-box');
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
  box.innerHTML = `
    <div class="pm-handle"></div>
    <div style="text-align:center;padding:20px 0 10px">
      <div style="font-size:3rem;margin-bottom:14px">üì©</div>
      <div style="font-size:1.1rem;font-weight:700;margin-bottom:10px">–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!</div>
      <div style="font-size:.82rem;color:var(--muted);line-height:1.8;margin-bottom:24px">
        –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ–ª—É—á–∏–ª –≤–∞—à—É –∑–∞—è–≤–∫—É<br>–∏ —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.
      </div>
      <button onclick="closeProxyModal()" style="width:100%;padding:13px;background:linear-gradient(135deg,var(--accent),#00b860);border:none;border-radius:100px;color:#fff;font-weight:700;cursor:pointer;font-size:.95rem">
        ‚úÖ –ü–æ–Ω—è—Ç–Ω–æ
      </button>
    </div>
  `;
  modal.classList.add('show');
}

// –°–≤–∞–π–ø –≤–Ω–∏–∑ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
(function(){
  let startY = 0;
  document.addEventListener('touchstart', e => {
    const box = document.getElementById('proxy-modal-box');
    if (box && box.contains(e.target)) startY = e.touches[0].clientY;
  }, {passive:true});
  document.addEventListener('touchend', e => {
    if (!startY) return;
    if (e.changedTouches[0].clientY - startY > 80) closeProxyModal();
    startY = 0;
  }, {passive:true});
})();


function showSt(msg,type){const e=document.getElementById('np-status');e.textContent=msg;e.className='np-status show '+type;}

/* ‚ïê‚ïê‚ïê‚ïê HAPTIC FEEDBACK ‚ïê‚ïê‚ïê‚ïê */
function haptic(pattern=[30]){
  if(navigator.vibrate) navigator.vibrate(pattern);
}
// –î–æ–±–∞–≤–ª—è–µ–º haptic –Ω–∞ –≤—Å–µ –∫–Ω–æ–ø–∫–∏
document.addEventListener('click',e=>{
  if(e.target.closest('.np-btn,.ob-btn,.bell-btn,.conn-pill,.offline-retry,.ib-install')){
    haptic([25]);
  }
});

/* ‚ïê‚ïê‚ïê‚ïê CONFETTI ‚ïê‚ïê‚ïê‚ïê */
function launchConfetti(){
  const canvas=document.getElementById('confetti-canvas');
  canvas.style.display='block';
  canvas.width=innerWidth;canvas.height=innerHeight;
  const ctx=canvas.getContext('2d');
  const pieces=[];
  const colors=['#00e676','#00b0ff','#ff6d00','#fff176','#f48fb1','#80deea'];
  for(let i=0;i<120;i++){
    pieces.push({
      x:Math.random()*canvas.width, y:-10-Math.random()*200,
      w:6+Math.random()*8, h:3+Math.random()*5,
      color:colors[Math.floor(Math.random()*colors.length)],
      angle:Math.random()*Math.PI*2, spin:(.5-Math.random())*.15,
      vx:(.5-Math.random())*4, vy:2+Math.random()*4,
      alpha:1
    });
  }
  let frame=0;
  function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    let alive=false;
    for(const p of pieces){
      p.x+=p.vx;p.y+=p.vy;p.angle+=p.spin;
      if(frame>60)p.alpha=Math.max(0,p.alpha-.012);
      if(p.alpha>0){alive=true;}
      ctx.save();ctx.globalAlpha=p.alpha;
      ctx.translate(p.x+p.w/2,p.y+p.h/2);ctx.rotate(p.angle);
      ctx.fillStyle=p.color;ctx.fillRect(-p.w/2,-p.h/2,p.w,p.h);
      ctx.restore();
    }
    if(alive){frame++;requestAnimationFrame(draw);}
    else{canvas.style.display='none';ctx.clearRect(0,0,canvas.width,canvas.height);}
  }
  draw();
  haptic([50,30,80,30,50]);
}

/* ‚ïê‚ïê‚ïê‚ïê LIVE TIMER ‚ïê‚ïê‚ïê‚ïê */
let timerInterval=null;
function startLiveTimer(){
  if(timerInterval)clearInterval(timerInterval);
  function tick(){
    const sub=loadSub();
    if(!sub.date){
      clearInterval(timerInterval);timerInterval=null;return;
    }
    const ms=new Date(sub.date)-Date.now();
    const days=Math.floor(ms/86400000);
    const pill=document.getElementById('hdr').querySelector('.conn-pill');
    if(ms<=0){
      txt.textContent='–∏—Å—Ç–µ–∫–ª–∞!';
      pill.className='conn-pill expired';
    } else if(days<=7){
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∂–∏–≤–æ–π –æ–±—Ä–∞—Ç–Ω—ã–π –æ—Ç—Å—á—ë—Ç
      const h=Math.floor((ms%86400000)/3600000);
      const m=Math.floor((ms%3600000)/60000);
      const s=Math.floor((ms%60000)/1000);
      if(days>0) txt.textContent=`${days}–¥ ${h}—á ${String(m).padStart(2,'0')}–º`;
      else txt.textContent=`${h}—á ${String(m).padStart(2,'0')}–º ${String(s).padStart(2,'0')}—Å`;
      pill.className='conn-pill urgent';
    } else {
      // –û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º ‚Äî –ø—Ä–æ—Å—Ç–æ –¥–Ω–∏
      txt.textContent=days+' –¥–Ω.';
      pill.className='conn-pill';
    }
  }
  tick();
  timerInterval=setInterval(tick,1000);
}

function openUrl(url){try{var w=window.open(url,'_blank');if(!w||w.closed){location.href=url;}}catch(e){location.href=url;}}
function openSupport(){openUrl('https://t.me/WeltkindVPN');}

/* INIT */
/* ‚ïê‚ïê‚ïê‚ïê CLEAR CACHE ‚ïê‚ïê‚ïê‚ïê */
async function clearAllCache(){
  // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
  if(!confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å –∫—ç—à?\n–î–∞–Ω–Ω—ã–µ –æ –ø–æ–¥–ø–∏—Å–∫–µ, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –∏—Å—Ç–æ—Ä–∏—è –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.')) return;

  // –û—á–∏—â–∞–µ–º localStorage / memStore
  try{ localStorage.removeItem('vpn_s'); }catch(e){}
  try{ localStorage.removeItem('vpn_hist'); }catch(e){}
  try{ localStorage.removeItem('onboarded'); }catch(e){}
  _memStore['vpn_s'] = null;
  _memStore['vpn_hist'] = null;
  _memStore['onboarded'] = null;

  // –û—á–∏—â–∞–µ–º Service Worker –∫—ç—à–∏
  if('caches' in window){
    try{
      const keys = await caches.keys();
      await Promise.all(keys.map(k => caches.delete(k)));
    }catch(e){}
  }

  // –û—Ç–ø–∏—Å—ã–≤–∞–µ–º Service Worker
  if('serviceWorker' in navigator){
    try{
      const regs = await navigator.serviceWorker.getRegistrations();
      await Promise.all(regs.map(r => r.unregister()));
    }catch(e){}
  }

  // –°–±—Ä–æ—Å –±–µ–π–¥–∂–∞
  updateBadge(null);
  if(timerIv) clearInterval(timerIv);
  document.getElementById('bell-badge').classList.remove('show');

  showSt('‚úÖ –ö—ç—à –æ—á–∏—â–µ–Ω! –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞...','ok');
  setTimeout(()=> location.reload(), 1200);
}

document.addEventListener('DOMContentLoaded',()=>{
  obInit();updateNet();startTimer();
  // updateProxyStatus –≤—ã–∑—ã–≤–∞–µ–º –í–°–ï–ì–î–ê ‚Äî –∫–Ω–æ–ø–∫–∞ –≤–∏–¥–∏–º–∞ —Å—Ä–∞–∑—É
  const _sub=loadSub();
  updateProxyStatus(_sub.proxyUrl||'');
  updateTgStatus(_sub);
  if(_sub.date){checkExpiry();}
  setInterval(checkExpiry,3600000);
  (function sched(){const now=new Date(),next=new Date(now);next.setHours(9,0,0,0);if(next<=now)next.setDate(next.getDate()+1);setTimeout(()=>{checkExpiry();sched();},next-now);})();
});

/* INSTALL */
let dp=null;
window.addEventListener('beforeinstallprompt',e=>{e.preventDefault();dp=e;setTimeout(()=>document.getElementById('install-banner').classList.add('show'),4000);});
document.getElementById('install-btn').onclick=async()=>{haptic('medium');document.getElementById('install-banner').classList.remove('show');if(dp){dp.prompt();await dp.userChoice;dp=null;}};
window.addEventListener('appinstalled',()=>document.getElementById('install-banner').classList.remove('show'));
</script>
<!-- ‚îÄ‚îÄ Confetti ‚îÄ‚îÄ -->
<canvas id="confetti-canvas"></canvas>

<!-- ‚îÄ‚îÄ Float support button ‚îÄ‚îÄ -->
<button id="float-support" onclick="haptic();openSupport()" title="–ü–æ–¥–¥–µ—Ä–∂–∫–∞">üí¨</button>
<div id="float-tooltip">–ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É</div>

<!-- FAB Telegram support -->
<a id="fab-support" href="#" target="_blank" onclick="haptic([30,20,60])" title="–ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É">
  <div class="fab-pulse"></div>
  <span>‚úàÔ∏è</span>
  <div class="fab-tooltip">–ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É</div>
</a>

<!-- Telegram connect banner -->
<div id="tg-banner">
  <div class="tg-banner-icon">üì≤</div>
  <div class="tg-banner-text">
    <strong>–ü–æ–¥–∫–ª—é—á–∏ Telegram</strong>
    <span>–ü–æ–ª—É—á–∞–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ–ø–ª–∞—Ç–µ</span>
  </div>
  <a id="tg-banner-btn" class="tg-banner-btn" href="#" target="_blank">–ü–æ–¥–∫–ª—é—á–∏—Ç—å</a>
  <button class="tg-banner-close" onclick="closeTgBanner()">‚úï</button>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê PROXY MODAL ‚ïê‚ïê‚ïê‚ïê -->
<div id="proxy-modal">
  <div id="proxy-modal-bg" onclick="closeProxyModal()"></div>
  <div id="proxy-modal-box">
    <div class="pm-handle"></div>
    <div class="pm-title">üì° Telegram –±–µ–∑ VPN</div>
    <div class="pm-sub">–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä Weltkind</div>

    <!-- –ü—Ä–æ–∫—Å–∏ –∞–∫—Ç–∏–≤–µ–Ω -->
    <div id="pm-active" style="display:none">
      <div class="pm-active-card">
        <div class="pm-active-status">
          <div class="pm-active-dot"></div>
          <div class="pm-active-label">–£—Å–ª—É–≥–∞ –∞–∫—Ç–∏–≤–Ω–∞ ‚úÖ</div>
        </div>
        <div class="pm-active-note">
          –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ ‚Äî Telegram —Å–∞–º –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–∫—Å–∏.<br>
          –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–∞–∂–∞—Ç—å <strong style="color:#fff">–ü–æ–¥–∫–ª—é—á–∏—Ç—å</strong> –≤ Telegram. –ì–æ—Ç–æ–≤–æ!
        </div>
        <a id="pm-connect-link" href="#" target="_blank" onclick="haptic([30,20,60])">
          <button class="pm-connect-btn">‚úàÔ∏è –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫ Telegram</button>
        </a>
      </div>
      <div class="pm-rules">
        <div class="pm-rules-title">üìã –£—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</div>
        <div class="pm-rule"><span class="pm-rule-icon">‚úÖ</span><span>–°–æ–æ–±—â–µ–Ω–∏—è, —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ, —Ñ–∞–π–ª—ã ‚Äî —Ä–∞–±–æ—Ç–∞—é—Ç</span></div>
        <div class="pm-rule"><span class="pm-rule-icon">‚úÖ</span><span>–ö–∞–Ω–∞–ª—ã, –≥—Ä—É–ø–ø—ã, –±–æ—Ç—ã ‚Äî —Ä–∞–±–æ—Ç–∞—é—Ç</span></div>
        <div class="pm-rule"><span class="pm-rule-icon">‚úÖ</span><span>–ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç</span></div>
        <div class="pm-rule"><span class="pm-rule-icon pm-rule-warn">‚ùå</span><span class="pm-rule-warn">–ì–æ–ª–æ—Å–æ–≤—ã–µ –∏ –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏ ‚Äî <strong>–Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç</strong></span></div>
        <div class="pm-rule"><span class="pm-rule-icon pm-rule-warn">‚ö†Ô∏è</span><span>–°—Ç—Ä–æ–≥–æ <strong>1 —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</strong> ‚Äî –ø—Ä–æ–∫—Å–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π</span></div>
        <div class="pm-rule"><span class="pm-rule-icon pm-rule-warn">üö´</span><span>–ü–µ—Ä–µ–¥–∞—á–∞ —Å—Å—ã–ª–∫–∏ –¥—Ä—É–≥–∏–º ‚Äî –∞–≤—Ç–æ–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –±–µ–∑ –≤–æ–∑–≤—Ä–∞—Ç–∞</span></div>
      </div>
    </div>

    <!-- –ü—Ä–æ–∫—Å–∏ –Ω–µ –∑–∞–∫–∞–∑–∞–Ω -->
    <div id="pm-order" style="display:none">
      <div class="pm-order-card">
        <div class="pm-price">100 ‚ÇΩ<span style="font-size:.9rem;font-weight:400"> / –º–µ—Å</span></div>
        <div class="pm-price-period">–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–∫—Å–∏ ¬∑ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ–±—è</div>
        <div style="font-size:.8rem;color:var(--muted);line-height:1.7;margin-bottom:14px">
          Telegram —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ VPN ‚Äî —Å–æ–æ–±—â–µ–Ω–∏—è, —Ñ–∞–π–ª—ã, –∫–∞–Ω–∞–ª—ã, –±–æ—Ç—ã.<br>
          –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ –ø—Ä–∏–≤—è–∑–∞–Ω–∞ —Ç–æ–ª—å–∫–æ –∫ —Ç–≤–æ–µ–º—É –∞–∫–∫–∞—É–Ω—Ç—É.
        </div>
        <button class="pm-order-btn" onclick="orderProxy()">üì© –ó–∞–∫–∞–∑–∞—Ç—å –∑–∞ 100 ‚ÇΩ/–º–µ—Å</button>
      </div>
      <div class="pm-rules">
        <div class="pm-rules-title">üìã –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</div>
        <div class="pm-rule"><span class="pm-rule-icon">‚úÖ</span><span>–°–æ–æ–±—â–µ–Ω–∏—è, —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ, —Ñ–∞–π–ª—ã, –∫–∞–Ω–∞–ª—ã, –±–æ—Ç—ã</span></div>
        <div class="pm-rule"><span class="pm-rule-icon pm-rule-warn">‚ùå</span><span class="pm-rule-warn">–ì–æ–ª–æ—Å–æ–≤—ã–µ –∏ –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏ ‚Äî –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è</span></div>
        <div class="pm-rule"><span class="pm-rule-icon pm-rule-warn">‚ö†Ô∏è</span><span>–°—Ç—Ä–æ–≥–æ <strong>1 —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</strong> ‚Äî –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å</span></div>
        <div class="pm-rule"><span class="pm-rule-icon pm-rule-warn">üö´</span><span>–ó–∞ –ø–µ—Ä–µ–¥–∞—á—É —Å—Å—ã–ª–∫–∏ ‚Äî –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –±–µ–∑ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è</span></div>
      </div>
    </div>

    <!-- –ù–µ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω -->
    <div id="pm-noauth" style="font-size:.8rem;color:var(--muted);text-align:center;padding:24px 0">
      –í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
    </div>
  </div>
</div>
</body>
</html>
